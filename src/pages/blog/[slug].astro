---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { blogPosts, getPostBySlug } from '../../data/blog';

export function getStaticPaths() {
  return Object.keys(blogPosts).map(slug => ({ params: { slug } }));
}

const { slug } = Astro.params;
const post = getPostBySlug(slug as string);

if (!post) {
  return Astro.redirect('/404');
}

const title = `${post.title} | María Ángeles Mata`;
---

<Layout title={title} description={post.excerpt}>
  <Header activePage="Blog" />
  
  <main id="main-content">
    
    <!-- Header del artículo -->
    <section class="pt-12 pb-8 bg-charcoal text-cream">
      <div class="container-editorial">
        
        <!-- Breadcrumbs -->
        <nav class="mb-6" aria-label="Migas de pan">
          <ol class="flex items-center gap-2 text-xs text-cream/50">
            <li><a href="/" class="hover:text-cream transition-colors">Inicio</a></li>
            <li class="text-cream/30">/</li>
            <li><a href="/blog" class="hover:text-cream transition-colors">Blog</a></li>
            <li class="text-cream/30">/</li>
            <li class="text-cream/70">{post.category}</li>
          </ol>
        </nav>
        
        <div class="max-w-3xl" data-reveal>
          <div class="flex items-center gap-3 mb-4">
            <span class="tag">{post.category}</span>
            <span class="text-xs text-cream/50">{post.date}</span>
            <span class="text-xs text-cream/50">· {post.readTime}</span>
          </div>
          
          <h1 class="font-serif text-3xl lg:text-4xl text-cream mb-4 leading-tight">
            {post.title}
          </h1>
          
          <p class="text-cream/60 text-base leading-relaxed">
            {post.excerpt}
          </p>
        </div>
      </div>
    </section>
    
    <!-- Imagen destacada -->
    <div class="relative -mt-4 mx-4 lg:mx-auto max-w-4xl" data-reveal>
      <div class="aspect-[21/9] rounded-xl overflow-hidden shadow-xl">
        <img 
          src={post.image} 
          alt={post.title} 
          class="w-full h-full object-cover"
          width="1200"
          height="514"
          loading="eager"
        />
      </div>
    </div>
    
    <!-- Contenido -->
    <section class="section-sm bg-cream">
      <div class="max-w-2xl mx-auto px-5">
        <div 
          class="prose prose-slate max-w-none
            prose-headings:font-serif prose-headings:text-charcoal prose-headings:font-normal
            prose-h2:text-xl prose-h2:mt-10 prose-h2:mb-4 prose-h2:leading-tight
            prose-h3:text-lg prose-h3:mt-8 prose-h3:mb-3 prose-h3:leading-snug
            prose-p:text-stone prose-p:leading-[1.8] prose-p:mb-5 prose-p:text-[15px]
            prose-a:text-sage prose-a:no-underline hover:prose-a:underline
            prose-strong:text-charcoal prose-strong:font-medium
            prose-ul:my-6 prose-ul:space-y-2
            prose-li:text-stone prose-li:marker:text-sage prose-li:text-[15px]
            prose-blockquote:border-l-2 prose-blockquote:border-sage prose-blockquote:bg-sage/5 prose-blockquote:py-4 prose-blockquote:px-5 prose-blockquote:rounded-r-lg prose-blockquote:my-8 prose-blockquote:not-italic
            prose-img:rounded-lg prose-img:shadow-md prose-img:my-6"
          set:html={post.content}
        />
        
        <!-- Autor -->
        <footer class="mt-12 pt-8 border-t border-border">
          <div class="card p-5 flex items-center gap-4">
            <div class="w-12 h-12 rounded-full bg-sage/10 flex items-center justify-center shrink-0">
              <span class="font-serif text-lg text-sage">M</span>
            </div>
            <div>
              <p class="font-serif text-base text-charcoal">María Ángeles Mata</p>
              <p class="text-xs text-gray">Psicóloga General Sanitaria · Colegiada nº AN-01452</p>
            </div>
          </div>
        </footer>
        
        <!-- Navegación inferior -->
        <div class="mt-8 pt-6 border-t border-border flex items-center justify-between">
          <a href="/contact" class="btn btn-sage text-xs">Reservar consulta</a>
          <a href="/blog" class="text-xs font-medium text-sage hover:text-charcoal flex items-center gap-1.5 transition-colors">
            <svg class="w-3.5 h-3.5 rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.75L21 12m0 0l-3.75 3.25M21 12H3" />
            </svg>
            <span>Más artículos</span>
          </a>
        </div>
      </div>
    </section>
  </main>
  
  <Footer />
</Layout>
